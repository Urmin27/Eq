<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inscription</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; background: #1a1a2e; color: white; }
        .container { width: 50%; margin: auto; padding: 20px; background: #16213e; border-radius: 10px; display: none; }
        input, button { margin: 10px; padding: 10px; font-size: 16px; width: 80%; }
        button { background: #00d4ff; color: white; border: none; cursor: pointer; }
        button:hover { background: #ffcc00; color: black; }
    </style>
</head>
<body>

    <h1>Programme de Parrainage</h1>
    <p id="invitationLinkContainer">
        <strong>Votre lien d'invitation :</strong> 
        <span id="invitationLink">G√©n√©ration...</span>
        <button onclick="copyInvitationLink()">üìã Copier</button>
    </p>

    <!-- Formulaire d'inscription -->
    <div class="container" id="signupForm">
        <h2>Inscription</h2>
        <input type="text" id="fullname" placeholder="Nom complet" required><br>
        <input type="email" id="email" placeholder="Email" required><br>
        <input type="text" id="phone" placeholder="T√©l√©phone" required><br>
        <input type="password" id="password" placeholder="Mot de passe" required><br>
        <button onclick="register()">S'inscrire</button><br>
        <p><a href="#" onclick="forgotPassword()">Mot de passe oubli√© ?</a></p>
    </div>

    <!-- Formulaire de r√©cup√©ration du mot de passe -->
    <div class="container" id="forgotPasswordForm">
        <h2>R√©cup√©ration du mot de passe</h2>
        <input type="text" id="recoveryInput" placeholder="Email ou T√©l√©phone" required><br>
        <button onclick="recoverPassword()">R√©cup√©rer</button><br>
        <p id="recoveredPassword"></p>
    </div>

    <script>
        function generateUserId() {
            return "USR" + Math.floor(Math.random() * 100000);
        }

        function generateInvitationLink(userId) {
            return window.location.origin + window.location.pathname + "?inscription=1";
        }

        function copyInvitationLink() {
            const invitationLink = generateInvitationLink(userId);
            navigator.clipboard.writeText(invitationLink)
                .then(() => {
                    alert("Lien copi√© !");
                    localStorage.setItem("canRegister", "yes");
                    window.location.href = invitationLink;
                });
        }

        let userId = localStorage.getItem("userId");
        if (!userId) {
            userId = generateUserId();
            localStorage.setItem("userId", userId);
        }

        document.getElementById("invitationLink").textContent = generateInvitationLink(userId);

        const urlParams = new URLSearchParams(window.location.search);
        const isFromInvitation = urlParams.get("inscription");

        if (isFromInvitation && localStorage.getItem("canRegister") === "yes") {
            document.getElementById("signupForm").style.display = "block";
            localStorage.removeItem("canRegister");
        }

        function register() {
            let fullname = document.getElementById("fullname").value;
            let email = document.getElementById("email").value;
            let phone = document.getElementById("phone").value;
            let password = document.getElementById("password").value;

            if (fullname && email && phone && password) {
                let userData = { fullname, email, phone, password };
                localStorage.setItem(email, JSON.stringify(userData));
                localStorage.setItem(phone, JSON.stringify(userData));

                alert("Inscription r√©ussie !");
                location.reload();
            } else {
                alert("Veuillez remplir tous les champs !");
            }
        }

        function forgotPassword() {
            document.getElementById("signupForm").style.display = "none";
            document.getElementById("forgotPasswordForm").style.display = "block";
        }

        function recoverPassword() {
            let recoveryInput = document.getElementById("recoveryInput").value;
            let userData = localStorage.getItem(recoveryInput);

            if (userData) {
                let user = JSON.parse(userData);
                document.getElementById("recoveredPassword").innerHTML = 
                    "Votre mot de passe est : <strong>" + user.password + "</strong>";
            } else {
                alert("Aucun compte trouv√© avec cet Email ou T√©l√©phone !");
            }
        }
    </script>

</body>
</html>
